# src/utils/serp_utils.py

import requests

def get_stock_info(query):
    """
    ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏´‡∏∏‡πâ‡∏ô (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô mock, ‡∏ï‡πà‡∏≠ API ‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï)
    """
    if "set" in query.lower():
        return "SET ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ: 1,234.56 (+4.56)"
    elif "ptt" in query.lower():
        return "PTT: 38.25 ‡∏ö‡∏≤‡∏ó (+0.25)"
    else:
        return "‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏∏‡πâ‡∏ô‡∏ô‡∏µ‡πâ"

def get_oil_price():
    """
    ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô (mock)
    """
    return (
        "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ:\n"
        "- ‡∏î‡∏µ‡πÄ‡∏ã‡∏•: 30.94\n"
        "- ‡πÅ‡∏Å‡πä‡∏™‡πÇ‡∏ã‡∏Æ‡∏≠‡∏•‡πå 95: 37.50\n"
        "- E20: 36.34 ‡∏ö‡∏≤‡∏ó"
    )

def get_lottery_result(date: str = None):
    """
    ‡∏î‡∏∂‡∏á‡∏ú‡∏•‡∏™‡∏•‡∏≤‡∏Å‡∏Å‡∏¥‡∏ô‡πÅ‡∏ö‡πà‡∏á‡∏£‡∏±‡∏ê‡∏ö‡∏≤‡∏•‡∏à‡∏£‡∏¥‡∏á (API: lottoth-api)
    - ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏ date ‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏á‡∏ß‡∏î‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
    - ‡∏£‡∏∞‡∏ö‡∏∏ date ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö 'YYYY-MM-DD'
    """
    api_url = "https://lottoth-api.vercel.app/api/latest"
    if date:
        api_url = f"https://lottoth-api.vercel.app/api/dates/{date}"
    try:
        res = requests.get(api_url, timeout=10)
        data = res.json()
        if not data or not data.get("data"):
            return "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏•‡∏™‡∏•‡∏≤‡∏Å (API)"
        d = data["data"]
        dt = d["date"]
        msg = (
            f"üìÖ ‡∏ú‡∏•‡∏™‡∏•‡∏≤‡∏Å‡∏Å‡∏¥‡∏ô‡πÅ‡∏ö‡πà‡∏á‡∏£‡∏±‡∏ê‡∏ö‡∏≤‡∏• ‡∏á‡∏ß‡∏î‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà {dt}\n"
            f"üèÜ ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 1: {d['reward1']}\n"
            f"üî¢ ‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤ 3 ‡∏ï‡∏±‡∏ß: {' '.join(d['front3'])}\n"
            f"üî¢ ‡πÄ‡∏•‡∏Ç‡∏ó‡πâ‡∏≤‡∏¢ 3 ‡∏ï‡∏±‡∏ß: {' '.join(d['back3'])}\n"
            f"üéØ ‡πÄ‡∏•‡∏Ç‡∏ó‡πâ‡∏≤‡∏¢ 2 ‡∏ï‡∏±‡∏ß: {d['back2']}\n"
            f"(‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: lottoth-api)"
        )
        return msg
    except Exception as e:
        return f"‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: {e}"

def get_crypto_price(coin):
    """
    ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡∏£‡∏¥‡∏õ‡πÇ‡∏ï (mock)
    """
    coin = coin.lower()
    if coin in ["btc", "bitcoin"]:
        return "Bitcoin (BTC): 2,350,000 ‡∏ö‡∏≤‡∏ó"
    elif coin in ["eth", "ethereum"]:
        return "Ethereum (ETH): 130,000 ‡∏ö‡∏≤‡∏ó"
    else:
        return f"‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç {coin.upper()}"

# --- ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ï‡πà‡∏≠ API ‡∏à‡∏£‡∏¥‡∏á (‡∏´‡∏∏‡πâ‡∏ô/‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô/‡∏Ñ‡∏£‡∏¥‡∏õ‡πÇ‡∏ï) ---
# 1. ‡∏´‡∏∏‡πâ‡∏ô‡πÑ‡∏ó‡∏¢: Finnomena API, SETTRADE API (‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏°‡∏±‡∏Ñ‡∏£)
# 2. ‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô: https://apigenerator.xyz/api/oil ‡∏´‡∏£‡∏∑‡∏≠ www.pttor.com
# 3. Crypto: CoinGecko API, CoinMarketCap API (‡∏ü‡∏£‡∏µ)
#
# (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÇ‡∏Ñ‡πâ‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á API ‡∏à‡∏£‡∏¥‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ï‡∏±‡∏ß ‡πÅ‡∏à‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏°‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!)
